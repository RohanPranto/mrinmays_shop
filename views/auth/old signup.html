<!-- views/signup.ejs -->

<%- include('../include/head.ejs', pageTitle='signup' ) %>

    </head>

    <body>
        <%- include('../include/navigation.ejs') %>

            <link rel="stylesheet" href="../css/login.css">
            <main>
                <div class="container signup_container" style="width: 20rem;">
                    <h1 style="text-align: center; margin-bottom: 1.5rem;">Sign Up!</h1>
                    <!-- Add the warning container -->
                    <div id="warning-container" class="warning-container"></div>
                    <form id="signup-form" action="/signup" method="post">

                        <div class="input-field">
                            <label for="name">Name:</label>
                            <input type="text" id="name" name="name" required>
                        </div>
                        <div class="input-field">
                            <label for="username">Username:</label>
                            <input type="text" id="username" name="username" required>
                        </div>
                        <div class="input-field">
                            <label for="email">Email id:</label>
                            <input type="email" id="email" name="email" required
                                pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$">
                            <span class="error-message">Enter a valid email address.</span>
                        </div>
                        <div class="input-field">
                            <label for="password">Password:</label>
                            <input type="password" id="password" name="password" required>
                        </div>
                        <button type="submit">Sign up</button>
                    </form>
                </div>
            </main>

            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    const emailInput = document.getElementById('email');
                    const errorMessage = document.querySelector('.error-message');
                    const inputField = document.querySelector('.input-field');

                    emailInput.addEventListener('input', function () {
                        // Check validity on input
                        if (emailInput.checkValidity()) {
                            errorMessage.style.display = 'none';
                            inputField.classList.remove('invalid');
                        } else {
                            errorMessage.style.display = 'block';
                            inputField.classList.add('invalid');
                        }
                    });

                    emailInput.addEventListener('blur', function () {
                        // Check validity on blur
                        if (emailInput.checkValidity()) {
                            errorMessage.style.display = 'none';
                            inputField.classList.remove('invalid');
                        } else {
                            errorMessage.style.display = 'block';
                            inputField.classList.add('invalid');
                        }
                    });
                });
                // Parse the query parameter from the URL
                const params = new URLSearchParams(window.location.search);
                const warningMessage = params.get('warning');

                // Display the warning message if it exists
                if (warningMessage) {
                    // Get the warning container element
                    const warningContainer = document.getElementById('warning-container');

                    // Set the warning message and make the container visible
                    warningContainer.innerHTML = `<strong>Warning:</strong> ${warningMessage}`;
                    warningContainer.style.display = 'block';
                }
            </script>
            <style>
                .warning-container {
                    background-color: #ffc107;
                    color: #333;
                    padding: 10px;
                    margin-bottom: 10px;
                    border: 1px solid #ffc107;
                    border-radius: 5px;
                    display: none;
                    /* Initially hide the container */
                }

                .error-message {
                    color: red;
                    font-size: 0.8rem;
                    display: none;
                }

                .input-field.invalid .error-message {
                    display: block;
                }
            </style>
            <%- include('../include/footer.ejs') %>


                <h2>Sign Up</h2>
                <form action="/signup" method="post">
                    <label for="username">Username:</label>
                    <input type="text" id="username" name="username"><br>

                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email"><br>

                    <label for="password">Password:</label>
                    <input type="password" id="password" name="password"><br>

                    <input type="submit" value="Sign Up">
                    <a href="/login">login</a>

                </form>